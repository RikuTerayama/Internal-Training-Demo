{% extends "base.html" %}

{% block header_nav %}
<nav class="breadcrumb">
    <a href="/">ãƒ›ãƒ¼ãƒ </a> > 
    <span>{{ topic|title }}</span> > 
    <span>çµæœ</span>
</nav>
{% endblock %}

{% block content %}
<div class="result-container">
    <div class="card result-summary-card">
        <h2>{{ topic|title }} - å­¦ç¿’çµæœ</h2>
        <div class="score-display">
            <div class="score-circle">
                <span class="score-number">{{ (score.correct / total_questions * 100)|round|int }}%</span>
                <span class="score-label">æ­£ç­”ç‡</span>
            </div>
            <div class="score-details">
                <p>æ­£è§£: <strong>{{ score.correct }}</strong> / {{ total_questions }}å•</p>
            </div>
        </div>
    </div>
    
    {% if incorrect_answers %}
    <div class="card incorrect-answers-card">
        <h3>èª¤ç­”ã—ãŸè¨­å•</h3>
        {% for item in incorrect_answers %}
        <div class="incorrect-item">
            <h4>{{ item.question.title }}</h4>
            <div class="answer-comparison">
                <div class="answer-box incorrect-box">
                    <strong>ã‚ãªãŸã®å›ç­”:</strong> {{ item.selected_choice }}
                </div>
                <div class="answer-box correct-box">
                    <strong>æ­£è§£:</strong> {{ item.correct_choice }}
                </div>
            </div>
            <div class="explanation-box">
                <p><strong>è§£èª¬:</strong> {{ item.question.explanation }}</p>
                <p><a href="{{ item.question.evidence_url }}" target="_blank" class="evidence-link">æ ¹æ‹ ãƒªãƒ³ã‚¯ â†’</a></p>
            </div>
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="card success-card">
        <h3>ğŸ‰ å…¨å•æ­£è§£ã§ã™ï¼</h3>
        <p>ç´ æ™´ã‚‰ã—ã„çµæœã§ã™ã€‚ã™ã¹ã¦ã®è¨­å•ã«æ­£è§£ã—ã¾ã—ãŸã€‚</p>
    </div>
    {% endif %}
    
    <div class="navigation-links">
        <a href="/" class="btn btn-primary">ä»–ã®ãƒ†ãƒ¼ãƒã‚’å­¦ç¿’ã™ã‚‹</a>
        <a href="/admin" class="btn btn-secondary">ç®¡ç†è€…ç”»é¢ã¸</a>
    </div>
</div>
{% endblock %}

